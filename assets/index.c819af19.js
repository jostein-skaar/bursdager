var u=Object.defineProperty;var f=(r,e,t)=>e in r?u(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var a=(r,e,t)=>(f(r,typeof e!="symbol"?e+"":e,t),t);import{P as g,h as d}from"./vendor.5b1ec22c.js";const k=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}};k();class y extends Phaser.Scene{constructor(){super({key:"hovedsene"});a(this,"bredde");a(this,"hoyde");a(this,"ballonggruppe");a(this,"spikergruppe");a(this,"kanongruppe");a(this,"tekst");a(this,"innstillinger",{maksAntallBallonger:10,tidMellomHverBallong:1e3,ballongfart:[30,40],spikerfart:-750});a(this,"ballongTeller",0)}init(e){console.log(e),this.bredde=this.game.scale.gameSize.width,this.hoyde=this.game.scale.gameSize.height,console.log({bredde:this.bredde,hoyde:this.hoyde}),this.scale.on("resize",(t,n,s,i,o,l)=>{console.log("resizea",{gameSize:t,baseSize:n,displaySize:s,resolution:i,previousWidth:o,previousHeight:l}),this.scene.restart()})}preload(){this.load.spritesheet("ballong","assets/ballonger-sprite.png",{frameWidth:40,frameHeight:50}),this.load.image("spiker","assets/spiker.png"),this.load.image("spikerkanon-topp","assets/spikerkanon-topp.png"),this.load.image("spikerkanon-bunn","assets/spikerkanon-bunn.png"),this.load.image("ballongkanon-topp","assets/ballongkanon-topp.png"),this.load.image("ballongkanon-bunn","assets/ballongkanon-bunn.png")}create(){this.ballonggruppe=this.physics.add.group({allowGravity:!1}),this.spikergruppe=this.physics.add.group({allowGravity:!1});const e=this.add.image(0,this.hoyde,"ballongkanon-bunn").setOrigin(0,1),t=this.add.image(35,this.hoyde-e.height+10,"ballongkanon-topp").setOrigin(0,1),n=this.add.image(this.bredde,this.hoyde,"spikerkanon-bunn").setOrigin(1,1),s=this.add.image(this.bredde-50,this.hoyde-n.height+15,"spikerkanon-topp").setOrigin(1,1);this.kanongruppe=this.physics.add.staticGroup(),this.kanongruppe.add(e),this.kanongruppe.add(t),this.kanongruppe.add(n),this.kanongruppe.add(s),this.kanongruppe.setDepth(1),e.setInteractive().on("pointerdown",()=>{this.lagNyBallong()}),t.setInteractive().on("pointerdown",()=>{this.lagNyBallong()}),n.setInteractive().on("pointerdown",()=>{this.skytSpiker()}),s.setInteractive().on("pointerdown",()=>{this.skytSpiker()}),this.physics.add.collider(this.ballonggruppe,this.ballonggruppe),this.physics.add.collider(this.kanongruppe,this.ballonggruppe),this.physics.add.collider(this.spikergruppe,this.ballonggruppe,(i,o)=>{o.disableBody(!0,!0);const l=this.ballonggruppe.countActive(!0);this.tekst.setText(this.lagTekst(l)),l===0&&this.scene.restart()}),this.tekst=this.add.text(this.bredde/2,this.hoyde-60,this.lagTekst(0),{fontFamily:"arial",fontSize:"20px",color:"#000"}).setOrigin(.5,1).setDepth(2)}update(e,t){this.spikergruppe.children.iterate(n=>{(n.x<0||n.y<0)&&n.disableBody(!0,!0)})}skytSpiker(){let e=this.spikergruppe.getFirstDead();const t=this.bredde-102,n=this.hoyde-190;e?e.enableBody(!0,t,n,!0,!0):e=this.spikergruppe.create(t,n,"spiker"),e.setSize(20,20).setAngle(-25).setImmovable(!0).setVelocity(this.innstillinger.spikerfart*.48,this.innstillinger.spikerfart)}lagMangeBallonger(){for(let e=0;e<this.innstillinger.maksAntallBallonger;e++)this.lagNyBallong2()}lagNyBallong(){let e=this.ballonggruppe.getFirstDead();const t=70,n=this.hoyde-90;e?e.enableBody(!0,t,n,!0,!0):e=this.ballonggruppe.create(t,n,"ballong",Phaser.Math.Between(0,14)),e.setSize(25,30).setBounce(1,1).setCollideWorldBounds(!0).setVelocity(Phaser.Math.Between(40,60),Phaser.Math.Between(-65,-85));const s=this.ballonggruppe.countActive(!0);this.tekst.setText(this.lagTekst(s))}lagNyBallong2(){const e=Phaser.Math.Between(0,this.bredde),t=Phaser.Math.Between(0,this.hoyde);this.ballonggruppe.create(e,t,"ballong",Phaser.Math.Between(0,14)).setSize(25,30).setBounce(1,1).setCollideWorldBounds(!0).setVelocity(Phaser.Math.Between(this.innstillinger.ballongfart[0],this.innstillinger.ballongfart[1]),Phaser.Math.Between(this.innstillinger.ballongfart[0],this.innstillinger.ballongfart[1]))}lagTekst(e){return`${e} `+(e===1?"ballong":"ballonger")}}let h,p=!0;p=!1;const b={type:g.AUTO,height:500,width:500,scene:[y],backgroundColor:16777215,autoFocus:!0,physics:{default:"arcade",arcade:{gravity:{y:300},debug:p}},scale:{mode:g.Scale.ScaleModes.RESIZE}};c();new g.Game(b);document.onvisibilitychange=()=>{document.visibilityState==="visible"&&Date.now()-h>60*1e3&&(console.log("visibilitychange. Og lenger enn 60 sekunder siden forrige."),c(),h=Date.now())};function c(){const r=[];new URLSearchParams(window.location.search).forEach((s,i)=>{r.push({navn:i.replaceAll("_"," "),dato:s})}),console.log(r);const t=document.querySelector("#personer");let n="";if(r.length>0){const s=m(r);for(const i of s){let o="";i.dager===0?o="HURRA":i.dager===1?o="1 dag":o=`${i.dager} dager`,n+=`<div class="person">${i.navn}: ${o}`}}else n+="Legg til navn og f\xF8dselsdatoer i urlen slik: ?Navn1=2010-12-01&Navn2a_Navn2b=2013-07-30";t.innerHTML=n}function m(r){const e=[];for(const t of r)e.push({navn:t.navn,dager:v(d(t.dato))});return e.sort((t,n)=>t.dager-n.dager)}function v(r){const e=d(),t=r.year(e.year());return e.isSame(t,"day")?0:(t<e&&(console.log(t.toJSON(),e),t.year(e.year()+1)),t.diff(d(),"days")+1)}
